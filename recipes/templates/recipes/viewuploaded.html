{% extends 'recipes/base.html' %}
{% block content %}
{% load static %}

<div class="container" id="main">
  
  <div class="row" id="recipe-cards">
    <!-- Dynamic recipe cards will be added here -->
  </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

<script>
  function showImages() {
    $.ajax({
      url: "{% url 'user_data' %}",
      method: "POST",
      contentType: "application/json",
      beforeSend: function(xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
      },
      data: JSON.stringify({
        item: "recipe",
      }),
      success: function(response) {
        for (const [key, value] of Object.entries(response)) {
          for (var i in value) {
            var card = document.createElement("div");
            card.className = "col-md-3 mb-4";

            // Create card content
            var cardContent = document.createElement("div");
            cardContent.className = "card";

                        // Create anchor tag for linking
                      // Create anchor tag for linking
            var cardLink = document.createElement("a");
            // Set custom data attribute to store card data
            cardLink.setAttribute("data-card-id", value[i]["id"]); // Example: Assuming "id" is the specific data you want to send
            // Add click event listener to handle card click
            cardLink.addEventListener("click", function(event) {
                event.preventDefault(); // Prevent default link behavior
                var cardId = this.getAttribute("data-card-id");
                alert(cardId);
                // Construct URL based on card data
                var redirectUrl = "{% url 'full_recipe' %}?id=" + cardId; // Example: Construct URL with card ID
                window.location.href = redirectUrl; // Redirect to the constructed URL
            });
            


            // Create card image
            var cardImage = document.createElement("img");
            var imagePath = "{% static '' %}" + value[i]["image"].replace(/\\/g, '/').replace('/static', '');
            cardImage.src = imagePath;
            cardImage.className = "card-img-top";
            cardImage.alt = value[i]["image"];

            // Create card body
            var cardBody = document.createElement("div");
            cardBody.className = "card-body";

            // Create card title
            var cardTitle = document.createElement("h5");
            cardTitle.className = "card-title";
            cardTitle.textContent = value[i]["title"];

            // Append elements to card body and list group
            cardBody.appendChild(cardTitle);

            // Append image and card body to card content
            cardContent.appendChild(cardImage);
            cardContent.appendChild(cardBody);

            // Append card content to card element
            cardLink.appendChild(cardContent);
            card.appendChild(cardLink);

            // Append card to recipe-cards container
            document.getElementById("recipe-cards").appendChild(card);
          }
        }
      },
      error: function(xhr, status, error) {
        console.error(xhr.responseText);
      },
    });
  }

  $(document).ready(function() {
    showImages();
  });
</script>
{% endblock content %}









{% comment %} sendButton.addEventListener("DOMContentLoaded",function()){
               const sendButton= document.getElementById('send_for_approval');
               sendButton.addEventListener("click", function() {
                 const url= "{% url 'send_for_approval' %}"
               }); {% endcomment %}